"use strict";(self.webpackChunksa_plotter2=self.webpackChunksa_plotter2||[]).push([[634],{9634:(e,a,r)=>{r.r(a),r.d(a,{default:()=>g});var t=r(8409),s=r(8903),o=r(3368),n=r(5865),i=r(9828),l=r(6446),d=r(7680),c=r(6240),p=r(5043),u=r(2019);const m=async e=>{var a,r,t;if(!e)return console.error("\u274c No pool selected"),{points:[],series:[]};const s={1:{name:"WETH-USD-1w",address:"0x31f7da25361ad99ca4daa4e8709624660f324f48",start:1631541600,end:1688998703},2:{name:"WBTC-USD-1w",address:"0x13d5387389ac1a3b72391d88b03b893a945b17cd",start:1631541600,end:1717353143},3:{name:"WBTC-ETH-1w",address:"0xb0105f829d50841b949c274636c2d173a78db7e0",start:1631541600,end:1669025951}},o=null===(a=s[e])||void 0===a?void 0:a.address,n=null===(r=s[e])||void 0===r?void 0:r.start,i=null===(t=s[e])||void 0===t?void 0:t.end;if(!o)return console.error("\u274c Invalid pool ID:",e),{points:[],series:[]};const l=`https://radiant-fjord-87733-0278092327b3.herokuapp.com/api/smartalpha/pools/${o}/pool-performance-chart/${n}/${i}`;try{const e=await fetch(l);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const a=await e.json();if(!a||!a.data||!Array.isArray(a.data))return console.error("\u274c Unexpected API response format",a),{points:[],series:[]};const r=a.data.map((e=>e.point)),t=[{name:"Junior without SA",data:a.data.map((e=>parseFloat(e.juniorWithoutSA)||0))},{name:"Junior with SA",data:a.data.map((e=>parseFloat(e.juniorWithSA)||0))},{name:"Senior without SA",data:a.data.map((e=>parseFloat(e.seniorWithoutSA)||0))},{name:"Senior with SA",data:a.data.map((e=>parseFloat(e.seniorWithSA)||0))},{name:"Token Price",data:a.data.map((e=>parseFloat(e.underlyingPrice)||0))}];return{points:r,series:t}}catch(d){return console.error("\u274c API Fetch Error:",d),{points:[],series:[]}}},h=async e=>{if(!e)return console.error("\u274c No user address provided"),{points:[],series:[]};const a=`https://radiant-fjord-87733-0278092327b3.herokuapp.com/api/smartalpha/users/${e}/portfolio-value`;try{console.log("\ud83d\udce1 Fetching User Portfolio Value from:",a);const e=await fetch(a);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const r=await e.json();if(console.log("\u2705 Raw API user portfolio Response:",r),!r||"object"!==typeof r)return console.error("\u274c Unexpected API response format",r),{points:[],series:[]};const t=r.data.map((e=>e.point)),s={points:t,series:[{name:"Junior Value",data:r.data.map((e=>parseFloat(e.juniorValue)||0))},{name:"Senior Value",data:r.data.map((e=>parseFloat(e.seniorValue)||0))},{name:"Entry Queue Value",data:r.data.map((e=>parseFloat(e.entryQueueValue)||0))},{name:"Exit Queue Value",data:r.data.map((e=>parseFloat(e.exitQueueValue)||0))}]};return console.log("\u2705 Parsed API Data:",s),s}catch(r){return console.error("\u274c API Fetch Error:",r),{points:[],series:[]}}};var A=r(579);const f={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0}};function y(e){let{selectedPool:a,userAddress:r}=e;const t=(0,c.A)(),{primary:s,secondary:o}=t.palette.text,n=t.palette.divider,[i,l]=(0,p.useState)(f),[d,y]=(0,p.useState)([]),[x,w]=(0,p.useState)([]);return(0,p.useEffect)((()=>{(async()=>{try{if(a&&!r){const{points:e,series:r}=await m(a);console.log("\u2705 Data received in IncomeAreaChart in pool performance:",{points:e,series:r}),e&&Array.isArray(e)&&0!==e.length||console.warn("\u26a0\ufe0f Points array is empty or invalid:",e),r&&Array.isArray(r)&&0!==r.length||console.warn("\u26a0\ufe0f Series array is empty or invalid:",r),w(e),y(r)}else if(null==a&&""!==r){const{points:e,series:a}=await h(r);console.log("\u2705 Data received in IncomeAreaChart in user portfolio:",{points:e,series:a}),e&&Array.isArray(e)&&0!==e.length||console.warn("\u26a0\ufe0f Points array is empty or invalid:",e),a&&Array.isArray(a)&&0!==a.length||console.warn("\u26a0\ufe0f Series array is empty or invalid:",a),w(e),y(a)}}catch(e){console.error("\u274c Error in loadChartData:",e)}})()}),[a,r]),(0,p.useEffect)((()=>{l((e=>({...e,colors:[t.palette.primary.main,t.palette.success.main,t.palette.warning.main,t.palette.error.main,t.palette.info.main],xaxis:{categories:x.length>0?x.map((e=>new Date(e).toLocaleString(void 0,{month:"short",day:"2-digit",year:"numeric"}))):[],labels:{style:{colors:new Array(30).fill(o)}},axisBorder:{show:!0,color:n},tickAmount:x.length>0?x.length-1:30},yaxis:{min:.9*Math.min(...d.flatMap((e=>e.data))),max:1.1*Math.max(...d.flatMap((e=>e.data))),labels:{formatter:e=>e.toFixed(0)}},grid:{borderColor:n}})))}),[s,o,n,t,x,d]),(0,A.jsx)(u.A,{options:i,series:d,type:"area",height:450})}function x(e){let{selectedPool:a,userAddress:r}=e;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(s.Ay,{container:!0,alignItems:"center",justifyContent:"space-between"}),(0,A.jsx)(d.A,{content:!1,sx:{mt:1.5,width:"100%"},children:(0,A.jsx)(l.A,{sx:{pt:1,pr:2},children:(0,A.jsx)(y,{selectedPool:a,userAddress:r})})})]})}const w={1:{name:"WETH-USD-1w",address:"0x31f7da25361ad99ca4daa4e8709624660f324f48",start:1631541600,end:1688998703},2:{name:"WBTC-USD-1w",address:"0x13d5387389ac1a3b72391d88b03b893a945b17cd",start:1631541600,end:1717353143},3:{name:"WBTC-ETH-1w",address:"0xb0105f829d50841b949c274636c2d173a78db7e0",start:1631541600,end:1669025951}};function g(){const[e,a]=(0,p.useState)("1"),[r,l]=(0,p.useState)("");return(0,A.jsxs)(s.Ay,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,A.jsx)(s.Ay,{item:!0,xs:12,sx:{mb:-2.25},children:(0,A.jsx)(o.A,{color:"primary","aria-label":"Pools",children:Object.entries(w).map((r=>{let[s,o]=r;return(0,A.jsx)(t.A,{onClick:()=>a(s),variant:e===s?"contained":"outlined",children:o.name},s)}))})}),(0,A.jsx)(s.Ay,{item:!0,children:(0,A.jsx)(n.A,{variant:"h5",children:"Pool Performance"})}),(0,A.jsx)(s.Ay,{item:!0,xs:12,md:7,lg:12,children:(0,A.jsx)(x,{selectedPool:e,userAddress:""})}),(0,A.jsx)(s.Ay,{item:!0,children:(0,A.jsx)(n.A,{variant:"h5",children:"User Portfolio Value"})}),(0,A.jsxs)(s.Ay,{item:!0,xs:12,md:7,lg:12,sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,A.jsx)(i.A,{label:"Enter User Address",variant:"outlined",fullWidth:!0,value:r,onChange:e=>l(e.target.value)}),(0,A.jsx)(t.A,{variant:"contained",color:"primary",onClick:()=>{console.log("\u2705 Saved User Address:",r),l(r)},children:"Plot"})]}),(0,A.jsx)(s.Ay,{item:!0,xs:12,md:7,lg:12,children:(0,A.jsx)(x,{selectedPool:null,userAddress:r})})]})}}}]);
//# sourceMappingURL=634.f01d1b59.chunk.js.map